import { j as s, c as V, d as z, s as T, M as E, i as W, p as R, a as H, x as J, r as N, t as q, l as U, u as G, b as Q, T as d, e as c, B as C, g as _, R as K, P as X, h as Y, a4 as Z, k as ee } from "./TriangleExclamation.BF0l2qmp.js";
import { s as se } from "./listener.DDzr0O6e.js";
import { s as te } from "./rtk-query.modern.BHWOgwdd.js";
import { a as ie } from "./SearchSidebar.Ch__xTOH.js";
import { M as y, a as S, b as ne, S as oe } from "./Menu.DJx8xQuO.js";
import { S as b } from "./TrashCan.Cpk_76bJ.js";
import { o as ae, s as x, F as re, I as u } from "./Input.DNTptJJI.js";
import { u as de } from "./index.esm.dAAmnfiQ.js";
const ce = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 512 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M18.8 232c8.2 0 15.1-6.2 16.5-14.3 5.7-33.3 18.8-64.1 37.5-90.7 4.7-6.7 4.3-16-1.5-21.8-6.7-6.7-17.8-6.2-23.3 1.5-22.5 31.4-38.2 68-44.6 107.7-1.6 9.4 5.9 17.6 15.4 17.6M127 72.8c26.5-18.7 57.3-31.8 90.6-37.6 8.2-1.3 14.4-8.2 14.4-16.4 0-9.5-8.2-17-17.5-15.4-39.8 6.4-76.4 22.1-107.8 44.6-7.7 5.5-8.2 16.6-1.5 23.3 5.8 5.8 15.1 6.3 21.8 1.5m153 420.4c0 9.5 8.2 17 17.5 15.4 39.7-6.5 76.4-22.1 107.7-44.6 7.7-5.5 8.2-16.6 1.5-23.3-5.8-5.8-15.1-6.3-21.8-1.5-26.5 18.7-57.3 31.8-90.6 37.6-8.1 1.4-14.3 8.2-14.3 16.5zM439.2 385c-4.7 6.7-4.3 16 1.5 21.8 6.7 6.7 17.8 6.2 23.3-1.5 22.5-31.4 38.2-68 44.6-107.7 1.5-9.4-5.9-17.5-15.4-17.5-8.2 0-15.1 6.2-16.5 14.3-5.7 33.3-18.8 64.1-37.6 90.6zm-334 55.7c-6.7 6.7-6.2 17.8 1.5 23.3 31.4 22.5 68 38.2 107.7 44.6 9.4 1.5 17.5-5.9 17.5-15.4 0-8.2-6.2-15.1-14.3-16.5-33.3-5.7-64.1-18.8-90.6-37.6-6.7-4.7-16-4.3-21.8 1.5zM48 405.3c5.5 7.7 16.6 8.2 23.3 1.5 5.8-5.8 6.3-15.1 1.5-21.8-18.7-26.6-31.8-57.4-37.5-90.7-1.4-8.1-8.3-14.3-16.5-14.3-9.5 0-17 8.2-15.4 17.5 6.4 39.8 22.1 76.4 44.6 107.8m358.8-334c6.7-6.7 6.2-17.8-1.5-23.3-31.4-22.5-68-38.2-107.7-44.6-9.4-1.6-17.6 5.9-17.6 15.4 0 8.2 6.2 15.1 14.3 16.5 33.3 5.7 64.1 18.8 90.7 37.5 6.7 4.7 16 4.3 21.8-1.5m32.4 55.7c18.7 26.5 31.8 57.3 37.6 90.6 1.4 8.1 8.2 14.3 16.5 14.3 9.5 0 17-8.2 15.4-17.5-6.5-39.7-22.1-76.4-44.6-107.7-5.5-7.7-16.6-8.2-23.3-1.5-5.8 5.8-6.3 15.1-1.5 21.8z" }) }), le = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 512 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256 256-114.6 256-256S397.4 0 256 0m0 480C132.5 480 32 379.5 32 256S132.5 32 256 32s224 100.5 224 224-100.5 224-224 224m0-176c8.844 0 16-7.156 16-16V128c0-8.844-7.156-16-16-16s-16 7.2-16 16v160c0 8.8 7.2 16 16 16m0 40c-13.25 0-24 10.75-24 24s10.75 24 24 24 24-10.75 24-24-10.7-24-24-24" }) }), pe = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 512 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M207.4 20.4c2.4 8.5-2.6 17.3-11.2 19.7C101.5 66.2 32 153 32 256c0 123.7 100.3 224 224 224s224-100.3 224-224c0-103-69.5-189.8-164.3-215.9-8.5-2.4-13.5-11.2-11.2-19.7s11.2-13.5 19.7-11.2C432.5 39.1 512 138.2 512 256c0 141.4-114.6 256-256 256S0 397.4 0 256C0 138.2 79.5 39.1 187.7 9.2c8.5-2.4 17.3 2.6 19.7 11.2" }) }), he = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 640 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M354.9 121.7c13.8 16 36.5 21.1 55.9 12.5 8.9-3.9 18.7-6.2 29.2-6.2 39.8 0 72 32.2 72 72q0 6-.9 11.7c-3.5 21.6 8.1 42.9 28.1 51.7C570.4 276.9 592 308 592 344c0 46.8-36.6 85.2-82.8 87.8-.6 0-1.3.1-1.9.2H144c-53 0-96-43-96-96 0-41.7 26.6-77.3 64-90.5 19.2-6.8 32-24.9 32-45.3v-.2c0-66.3 53.7-120 120-120 36.3 0 68.8 16.1 90.9 41.7M512 480v-.2c71.4-4.1 128-63.3 128-135.8 0-55.7-33.5-103.7-81.5-124.7 1-6.3 1.5-12.8 1.5-19.3 0-66.3-53.7-120-120-120-17.4 0-33.8 3.7-48.7 10.3C360.4 54.6 314.9 32 264 32c-92.8 0-168 75.2-168 168v.2C40.1 220 0 273.3 0 336c0 79.5 64.5 144 144 144h368M223 313l80 80c9.4 9.4 24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-39 39V184c0-13.3-10.7-24-24-24s-24 10.7-24 24v134.1l-39-39c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9z" }) }), me = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 384 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M320 480H64c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32h128v112c0 26.5 21.5 48 48 48h112v256c0 17.7-14.3 32-32 32m-80-320c-8.8 0-16-7.2-16-16V32.5c2.8.7 5.4 2.1 7.4 4.2l115.9 115.9c2.1 2.1 3.5 4.6 4.2 7.4zM64 0C28.7 0 0 28.7 0 64v384c0 35.3 28.7 64 64 64h256c35.3 0 64-28.7 64-64V163.9c0-12.7-5.1-24.9-14.1-33.9L254.1 14.1c-9-9-21.2-14.1-33.9-14.1zm91.3 299.3c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0l-48 48c-6.2 6.2-6.2 16.4 0 22.6l48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6L118.6 336zm144 25.4-48-48c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l36.7 36.7-36.7 36.7c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0l48-48c6.2-6.2 6.2-16.4 0-22.6" }) }), ge = (e) => /* @__PURE__ */ s.jsx("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 512 512", width: "1em", height: "1em", ...e, children: /* @__PURE__ */ s.jsx("path", { d: "M448 464H192c-8.8 0-16-7.2-16-16v-80h-48v80c0 35.3 28.7 64 64 64h256c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3l-90.6-90.5C390.7 6.7 374.5 0 357.5 0H192c-35.3 0-64 28.7-64 64v192h48V64c0-8.8 7.2-16 16-16h160v80c0 17.7 14.3 32 32 32h80v288c0 8.8-7.2 16-16 16M297 215c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l39 39H24c-13.3 0-24 10.7-24 24s10.7 24 24 24h278.1l-39 39c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9l-80-80z" }) }), fe = {
  items: [],
  selectedId: void 0
}, F = V({
  name: "capture",
  initialState: fe,
  reducers: {
    showCaptureWindow: (e, t) => {
      e.items = t.payload, e.selectedId = t.payload.length > 0 ? t.payload[0].id : void 0;
    },
    setSelectedItemId: (e, t) => {
      e.selectedId = t.payload;
    },
    selectFiles: (e, t) => {
    },
    convert: (e, t) => {
      const o = t.payload.id, i = e.items.filter((n) => n.id === o)[0];
      i.status = "running", i.log = [], i.downloadedFile = void 0;
    },
    saveCapture: (e, t) => {
      const o = e.items.findIndex((i) => i.id === t.payload.id);
      o !== -1 ? e.items[o] = t.payload : (e.items.unshift(t.payload), e.selectedId = t.payload.id);
    },
    saveCaptureSettings: (e, t) => {
      const { id: o, settings: i } = t.payload, n = e.items.findIndex((a) => a.id === o);
      n !== -1 && (e.items[n].prepareOptions = i.prepareOptions);
    },
    downloadFile: (e, t) => {
    },
    deleteJob: (e, { payload: { id: t } }) => {
      var o;
      e.items = e.items.filter((i) => i.id !== t), e.selectedId = (o = e.items[0]) == null ? void 0 : o.id;
    },
    deleteFile: (e, t) => {
      const { id: o, file: i } = t.payload, n = e.items.find((a) => a.id === o);
      n && (n.files = n.files.filter((a) => a !== i));
    },
    openLink: (e, t) => {
    }
  }
}), {
  showCaptureWindow: I,
  selectFiles: p,
  saveCaptureSettings: M,
  convert: L,
  saveCapture: xe,
  downloadFile: P,
  deleteJob: k,
  deleteFile: A,
  openLink: O,
  setSelectedItemId: ue
} = F.actions, ve = F.reducer, D = z(), r = D.startListening;
function we(e, t) {
  const o = () => r({
    actionCreator: I,
    effect: async (n, a) => {
      a.dispatch(E(["main", "capture"]));
    }
  }), i = {
    selectFiles: () => r({
      actionCreator: p,
      effect: async (n, a) => {
        e.postMessage({
          command: "selectFiles",
          payload: n.payload
        });
      }
    }),
    saveCaptureSettings: () => r({
      matcher: W(M, A),
      effect: async (n, a) => {
        const l = n.payload.id, f = a.getState().capture.items.find((B) => B.id === l);
        e.postMessage({
          command: "saveCaptureSettings",
          payload: {
            id: l,
            settings: {
              files: f.files,
              prepareOptions: f.prepareOptions
            }
          }
        });
      }
    }),
    convert: () => r({
      actionCreator: L,
      effect: async (n, a) => {
        e.postMessage({
          command: "convert",
          payload: n.payload
        });
      }
    }),
    downloadFile: () => r({
      actionCreator: P,
      effect: async (n, a) => {
        e.postMessage({
          command: "downloadFile",
          payload: n.payload
        });
      }
    }),
    deleteJob: () => r({
      actionCreator: k,
      effect: async (n, a) => {
        e.postMessage({
          command: "deleteJob",
          payload: n.payload
        });
      }
    }),
    openLink: () => r({
      actionCreator: O,
      effect: async (n, a) => {
        e.postMessage({
          command: "openLink",
          payload: n.payload
        });
      }
    })
  };
  return se(r, t), T({ ...i, onShowCaptureWindow: o }), D;
}
const je = {
  theme: q,
  capture: ve,
  router: N,
  confirmationDialog: J
}, Ce = {
  changeTheme: R,
  showCaptureWindow: I,
  saveCapture: xe
}, ye = (e, t) => {
  const o = H({
    reducer: je,
    middleware: (i) => i().prepend(e.middleware).concat(U),
    preloadedState: {
      theme: t
    }
  });
  return te(o.dispatch), o;
}, h = () => G(), $ = Q;
function Se() {
  const e = h(), { selectedId: t, items: o } = $((n) => n.capture), i = o.find((n) => n.id === t);
  return i ? /* @__PURE__ */ s.jsx(
    re,
    {
      wrapFormData: Fe,
      unwrapFormData: Ie,
      useFormMode: "onChange",
      data: i.prepareOptions,
      schema: Ae,
      saveData: (n) => {
        e(
          M({
            id: i.id,
            settings: { files: i.files, prepareOptions: n }
          })
        );
      },
      children: /* @__PURE__ */ s.jsx(be, { item: i })
    }
  ) : /* @__PURE__ */ s.jsx("div", { children: "No job selected" });
}
function be({ item: e }) {
  const t = h(), {
    formState: { isValid: o }
  } = de();
  return /* @__PURE__ */ s.jsxs("div", { children: [
    /* @__PURE__ */ s.jsx(g, { children: "Selected files" }),
    /* @__PURE__ */ s.jsxs(Pe, { children: [
      e.files && /* @__PURE__ */ s.jsx("div", { children: e.files.map((i, n) => /* @__PURE__ */ s.jsxs(Me, { children: [
        /* @__PURE__ */ s.jsx(me, {}),
        " ",
        Oe(i),
        /* @__PURE__ */ s.jsx(y, { children: /* @__PURE__ */ s.jsxs(S, { onSelect: () => t(A({ id: e.id, file: i })), children: [
          /* @__PURE__ */ s.jsx(b, {}),
          "Delete"
        ] }) })
      ] }, `item-${e.id}-file-${n}`)) }),
      (e.status === "pending" || e.status === "failed") && /* @__PURE__ */ s.jsxs(
        m,
        {
          onClick: (i) => {
            t(p({ id: e.id })), i.stopPropagation(), i.preventDefault();
          },
          children: [
            /* @__PURE__ */ s.jsx(ge, {}),
            "Select files"
          ]
        }
      ),
      (e.status === "pending" || e.status === "failed") && e.files.length > 0 && /* @__PURE__ */ s.jsxs(
        m,
        {
          $disabled: !o,
          onClick: (i) => {
            o && t(L({ id: e.id })), i.stopPropagation(), i.preventDefault();
          },
          children: [
            /* @__PURE__ */ s.jsx(ne, {}),
            "Generate"
          ]
        }
      ),
      e.status === "finished" && /* @__PURE__ */ s.jsxs(
        m,
        {
          onClick: (i) => {
            t(P({ id: e.id })), i.stopPropagation(), i.preventDefault();
          },
          children: [
            /* @__PURE__ */ s.jsx(he, {}),
            "Save OpenAPI file"
          ]
        }
      )
    ] }),
    /* @__PURE__ */ s.jsx(v, {}),
    /* @__PURE__ */ s.jsx(g, { children: "Options" }),
    /* @__PURE__ */ s.jsxs(Le, { children: [
      /* @__PURE__ */ s.jsx(u, { label: "Base Path", name: "basePath" }),
      /* @__PURE__ */ s.jsx(u, { label: "Servers", name: "servers" })
    ] }),
    /* @__PURE__ */ s.jsx(v, {}),
    /* @__PURE__ */ s.jsx(g, { children: "Logs" }),
    /* @__PURE__ */ s.jsxs(ke, { children: [
      e.log.map((i, n) => /* @__PURE__ */ s.jsx("div", { children: i }, n)),
      e.downloadedFile && /* @__PURE__ */ s.jsxs("div", { children: [
        "OpenAPI file saved to",
        " ",
        /* @__PURE__ */ s.jsx(
          "a",
          {
            href: "#",
            onClick: (i) => {
              i.preventDefault(), i.stopPropagation(), t(O(e.downloadedFile || ""));
            },
            children: e.downloadedFile
          }
        )
      ] }, `item-${e.id}-log-${e.log.length}`)
    ] })
  ] });
}
function Fe(e) {
  return { basePath: e.basePath, servers: e.servers.join(",") };
}
function Ie(e) {
  return { basePath: e.basePath, servers: e.servers.split(",") };
}
const m = c.div`
  display: flex;
  padding: 0 8px;
  gap: 4px;
  align-items: center;
  cursor: pointer;
  color: var(
    ${({ $disabled: e }) => e ? d.disabledForeground : d.linkForeground}
  );
  > svg {
    fill: var(
      ${({ $disabled: e }) => e ? d.disabledForeground : d.linkForeground}
    );
  }
`, Me = c.div`
  display: flex;
  padding: 0 8px;
  gap: 4px;
  align-items: center;
  > svg {
    fill: var(${d.foreground});
  }
  > span:last-child {
    visibility: hidden;
  }
  &:hover > span:last-child {
    visibility: visible;
  }
`, g = c.div`
  margin-top: 16px;
  margin-bottom: 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(${d.foreground});
`, Le = c.div`
  margin-top: 16px;
  margin-bottom: 16px;
  display: flex;
  flex-direction: column;
  max-width: 600px;
  gap: 16px;
`, Pe = c.div`
  display: flex;
  flex-direction: row;
  padding-bottom: 8px;
  align-items: start;
`, ke = c.div`
  font-family: monospace;
  display: flex;
  flex-direction: column;
  gap: 4px;
`, v = c.hr`
  border: none;
  border-top: 1px solid var(${d.border});
`, Ae = ae({
  basePath: x().min(1).trim(),
  servers: x().min(1).refine(
    (e) => e.split(",").map((t) => t.trim()).filter((t) => t.length > 0).every((t) => t.startsWith("http://") || t.startsWith("https://")),
    {
      message: "Invalid format. Examples: 'https://foo.com, http://bar.org'"
    }
  )
});
function Oe(e) {
  return decodeURIComponent(e.substring(e.lastIndexOf("/") + 1));
}
function De() {
  const e = h();
  return /* @__PURE__ */ s.jsxs("div", { children: [
    /* @__PURE__ */ s.jsx("h1", { children: "Welcome to the Capture App" }),
    /* @__PURE__ */ s.jsx("p", { children: "This is the starting point for capturing API requests." }),
    /* @__PURE__ */ s.jsx(
      C,
      {
        onClick: (t) => {
          e(p({ id: void 0 }));
        },
        children: "Select files"
      }
    )
  ] });
}
function $e() {
  const e = h(), { items: t, selectedId: o } = $((a) => a.capture), i = ({ sectionId: a, itemId: l }) => e(ue(l)), n = [
    {
      id: "capture",
      title: "Capture",
      items: t.map((a) => ({
        id: a.id,
        label: Be(a),
        icon: Ve(a.status),
        menu: /* @__PURE__ */ s.jsx(y, { children: /* @__PURE__ */ s.jsxs(
          S,
          {
            onClick: (l) => l.stopPropagation(),
            disabled: a.status === "running",
            onSelect: () => e(k({ id: a.id })),
            children: [
              /* @__PURE__ */ s.jsx(b, {}),
              "Delete"
            ]
          }
        ) })
      }))
    }
  ];
  return /* @__PURE__ */ s.jsx(
    ie,
    {
      selected: o ? { sectionId: "capture", itemId: o } : void 0,
      onSelected: i,
      title: "Quickgen sessions",
      noSectionTitles: !0,
      hideEmptySidebar: !0,
      sections: n,
      render: () => /* @__PURE__ */ s.jsx(Se, {}),
      renderEmpty: () => /* @__PURE__ */ s.jsx(De, {}),
      renderButtons: () => /* @__PURE__ */ s.jsx("div", { children: /* @__PURE__ */ s.jsx(
        C,
        {
          style: { width: "100%" },
          onClick: (a) => {
            e(p({ id: void 0 }));
          },
          children: "New session"
        }
      ) })
    }
  );
}
function Be(e) {
  if (!e.files || e.files.length === 0)
    return "No files";
  const t = e.files[0];
  return e.files.length > 1 ? `${w(t)}+(${e.files.length - 1})` : w(t);
}
function w(e) {
  return decodeURIComponent(e.substring(e.lastIndexOf("/") + 1));
}
function Ve(e) {
  switch (e) {
    case "pending":
      return /* @__PURE__ */ s.jsx(ce, {});
    case "running":
      return /* @__PURE__ */ s.jsx(pe, { className: "spinning" });
    case "finished":
      return /* @__PURE__ */ s.jsx(oe, {});
    case "failed":
      return /* @__PURE__ */ s.jsx(le, {});
  }
}
const j = [
  {
    id: "starting",
    title: "",
    navigation: !1,
    element: /* @__PURE__ */ s.jsx("div", {})
  },
  {
    id: "main",
    title: "Main",
    element: /* @__PURE__ */ s.jsx("div", { children: "Main" }),
    children: [
      {
        id: "capture",
        title: "Capture",
        element: /* @__PURE__ */ s.jsx("div", { style: { position: "fixed", top: 0, left: 0, right: 0, bottom: 0 }, children: /* @__PURE__ */ s.jsx($e, {}) })
      }
    ]
  }
];
function ze(e, t) {
  const o = ye(we(e, j), t);
  _.createRoot(document.getElementById("root")).render(
    /* @__PURE__ */ s.jsx(K.StrictMode, { children: /* @__PURE__ */ s.jsx(X, { store: o, children: /* @__PURE__ */ s.jsx(Y.Provider, { value: j, children: /* @__PURE__ */ s.jsx(Z, {}) }) }) })
  ), window.addEventListener("message", ee(o, Ce));
}
window.renderWebView = ze;
